import{S as t,a as e,s as n,o as a,b as s,c as o,h as l,n as r,d as c,am as i,w as m,x as $,F as f,D as u,G as d,P as g,aq as p,K as h,e as x,g as b,L as w,j as v,k,l as y,C as j,E as L,an as M,ap as B,ar as D,m as R,Y as _,Z as z,R as T,T as C,a3 as E,a4 as N,as as S,W as U,J as H,at as I,ad as P,r as V,a2 as Z,au as q,av as A,ae as F,u as G,af as J,aw as K}from"./main-886bb043.js";import{T as W,a as Y,R as O,M as Q,d as X,c as tt,b as et,U as nt}from"./MoveTo-f0be0fb6.js";function at(t){let e,n;return{c(){e=a("svg"),n=a("path"),s(n,"d","M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"),s(n,"fill",t[2]),s(e,"width",t[0]),s(e,"height",t[1]),s(e,"viewBox",t[3])},m(t,a){o(t,e,a),l(e,n)},p(t,[a]){4&a&&s(n,"fill",t[2]),1&a&&s(e,"width",t[0]),2&a&&s(e,"height",t[1]),8&a&&s(e,"viewBox",t[3])},i:r,o:r,d(t){t&&c(e)}}}function st(t,e,n){let{size:a="1em"}=e,{width:s=a}=e,{height:o=a}=e,{color:l="currentColor"}=e,{viewBox:r="0 0 24 24"}=e;return t.$set=t=>{"size"in t&&n(4,a=t.size),"width"in t&&n(0,s=t.width),"height"in t&&n(1,o=t.height),"color"in t&&n(2,l=t.color),"viewBox"in t&&n(3,r=t.viewBox)},[s,o,l,r,a]}class ot extends t{constructor(t){super(),e(this,t,st,at,n,{size:4,width:0,height:1,color:2,viewBox:3})}}function lt(t,e,n){const a=t.slice();return a[5]=e[n],a}function rt(t){let e,n,a=t[2].length+"";return{c(){e=x("x-count"),n=b(a),w(e,"class","svelte-d56671")},m(t,a){o(t,e,a),l(e,n)},p(t,e){4&e&&a!==(a=t[2].length+"")&&v(n,a)},d(t){t&&c(e)}}}function ct(t){let e,n,a,s;const r=new p({}),i=new h({});let g=t[2].length&&rt(t);return{c(){e=x("x-action"),m(r.$$.fragment),n=k(),m(i.$$.fragment),a=k(),g&&g.c(),w(e,"slot","activator"),w(e,"class","btn-dark"),w(e,"data-tooltip","Archivos adjuntos")},m(t,c){o(t,e,c),$(r,e,null),l(e,n),$(i,e,null),l(e,a),g&&g.m(e,null),s=!0},p(t,n){t[2].length?g?g.p(t,n):(g=rt(t),g.c(),g.m(e,null)):g&&(g.d(1),g=null)},i(t){s||(f(r.$$.fragment,t),f(i.$$.fragment,t),s=!0)},o(t){u(r.$$.fragment,t),u(i.$$.fragment,t),s=!1},d(t){t&&c(e),d(r),d(i),g&&g.d()}}}function it(t){let e,n,a,r,i,m,$=t[5].filename+"";return{c(){e=x("x-item"),n=x("img"),r=k(),i=b($),m=k(),n.src!==(a=D(t[5].filename))&&s(n,"src",a),s(n,"alt",""),s(n,"class","svelte-d56671"),w(e,"class","svelte-d56671")},m(t,a){o(t,e,a),l(e,n),l(e,r),l(e,i),o(t,m,a)},p(t,e){4&e&&n.src!==(a=D(t[5].filename))&&s(n,"src",a),4&e&&$!==($=t[5].filename+"")&&v(i,$)},d(t){t&&c(e),t&&c(m)}}}function mt(t){let e;const n=new B({props:{href:"/download/"+t[3].id+"/"+t[4].id+"/"+t[5].id+"?filename="+encodeURIComponent(t[5].filename),download:!0,target:"_blank",$$slots:{default:[it]},$$scope:{ctx:t}}});return{c(){m(n.$$.fragment)},m(t,a){$(n,t,a),e=!0},p(t,e){const a={};28&e&&(a.href="/download/"+t[3].id+"/"+t[4].id+"/"+t[5].id+"?filename="+encodeURIComponent(t[5].filename)),260&e&&(a.$$scope={dirty:e,ctx:t}),n.$set(a)},i(t){e||(f(n.$$.fragment,t),e=!0)},o(t){u(n.$$.fragment,t),e=!1},d(t){d(n,t)}}}function $t(t){let e,n,a,s=t[2],l=[];for(let e=0;e<s.length;e+=1)l[e]=mt(lt(t,s,e));const r=t=>u(l[t],1,1,()=>{l[t]=null});return{c(){e=k();for(let t=0;t<l.length;t+=1)l[t].c();n=y()},m(t,s){o(t,e,s);for(let e=0;e<l.length;e+=1)l[e].m(t,s);o(t,n,s),a=!0},p(t,e){if(28&e){let a;for(s=t[2],a=0;a<s.length;a+=1){const o=lt(t,s,a);l[a]?(l[a].p(o,e),f(l[a],1)):(l[a]=mt(o),l[a].c(),f(l[a],1),l[a].m(n.parentNode,n))}for(j(),a=s.length;a<l.length;a+=1)r(a);L()}},i(t){if(!a){for(let t=0;t<s.length;t+=1)f(l[t]);a=!0}},o(t){l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)u(l[t]);a=!1},d(t){t&&c(e),M(l,t),t&&c(n)}}}function ft(t){let e;const n=new i({props:{origin:"top right",$$slots:{default:[$t],activator:[ct]},$$scope:{ctx:t}}});return{c(){m(n.$$.fragment)},m(t,a){$(n,t,a),e=!0},p(t,[e]){const a={};284&e&&(a.$$scope={dirty:e,ctx:t}),n.$set(a)},i(t){e||(f(n.$$.fragment,t),e=!0)},o(t){u(n.$$.fragment,t),e=!1},d(t){d(n,t)}}}function ut(t,e,n){let a,s,o=r,l=()=>(o(),o=g(m,t=>n(3,a=t)),m),c=r,i=()=>(c(),c=g($,t=>n(4,s=t)),$);t.$$.on_destroy.push(()=>o()),t.$$.on_destroy.push(()=>c());let{mailbox:m}=e;l();let{message:$}=e;i();let{attachments:f}=e;return t.$set=t=>{"mailbox"in t&&l(n(0,m=t.mailbox)),"message"in t&&i(n(1,$=t.message)),"attachments"in t&&n(2,f=t.attachments)},[m,$,f,a,s]}class dt extends t{constructor(t){super(),e(this,t,ut,ft,n,{mailbox:0,message:1,attachments:2})}}function gt(t){let e;const n=new tt({});return{c(){m(n.$$.fragment)},m(t,a){$(n,t,a),e=!0},i(t){e||(f(n.$$.fragment,t),e=!0)},o(t){u(n.$$.fragment,t),e=!1},d(t){d(n,t)}}}function pt(t){let e;const n=new et({});return{c(){m(n.$$.fragment)},m(t,a){$(n,t,a),e=!0},i(t){e||(f(n.$$.fragment,t),e=!0)},o(t){u(n.$$.fragment,t),e=!1},d(t){d(n,t)}}}function ht(t){let e,n,a,s;const i=new F({}),g=new h({});return{c(){e=x("x-action"),m(i.$$.fragment),n=k(),m(g.$$.fragment),w(e,"class","btn-dark"),w(e,"data-tooltip","Marcar como spam")},m(r,c,m){o(r,e,c),$(i,e,null),l(e,n),$(g,e,null),a=!0,m&&s(),s=R(e,"click",t[12])},p:r,i(t){a||(f(i.$$.fragment,t),f(g.$$.fragment,t),a=!0)},o(t){u(i.$$.fragment,t),u(g.$$.fragment,t),a=!1},d(t){t&&c(e),d(i),d(g),s()}}}function xt(t){let e,n,a,s;const i=new nt({}),g=new h({});return{c(){e=x("x-action"),m(i.$$.fragment),n=k(),m(g.$$.fragment),w(e,"class","btn-dark"),w(e,"data-tooltip","No es spam")},m(r,c,m){o(r,e,c),$(i,e,null),l(e,n),$(g,e,null),a=!0,m&&s(),s=R(e,"click",t[12])},p:r,i(t){a||(f(i.$$.fragment,t),f(g.$$.fragment,t),a=!0)},o(t){u(i.$$.fragment,t),u(g.$$.fragment,t),a=!1},d(t){t&&c(e),d(i),d(g),s()}}}function bt(t){let e,n;const a=new dt({props:{mailbox:t[0],message:t[1],attachments:t[4].attachments}});return{c(){e=x("x-action-group"),m(a.$$.fragment)},m(t,s){o(t,e,s),$(a,e,null),n=!0},p(t,e){const n={};1&e&&(n.mailbox=t[0]),2&e&&(n.message=t[1]),16&e&&(n.attachments=t[4].attachments),a.$set(n)},i(t){n||(f(a.$$.fragment,t),n=!0)},o(t){u(a.$$.fragment,t),n=!1},d(t){t&&c(e),d(a)}}}function wt(t){let e,n,a,i,g,p,b,v,M,B,D,_,z,T,C,E,N,S,U,I,Z,q,A,F,G,J,K,W,Y;const tt=new ot({}),et=new h({}),nt=new h({}),at=[pt,gt],st=[];function lt(t,e){return t[4].seen?0:1}M=lt(t),B=st[M]=at[M](t);const rt=[xt,ht],ct=[];~(z=function(t,e){return t[7]?0:t[9]||t[10]||t[8]?-1:1}(t))&&(T=ct[z]=rt[z](t));const it=new P({}),mt=new h({}),$t=new O({}),ft=new h({});let ut=!t[9]&&!t[10]&&function(t){let e,n,a,s;const i=new X({}),g=new h({});return{c(){e=x("x-action"),m(i.$$.fragment),n=k(),m(g.$$.fragment),w(e,"class","btn-dark"),w(e,"data-tooltip","Responder")},m(r,c,m){o(r,e,c),$(i,e,null),l(e,n),$(g,e,null),a=!0,m&&s(),s=R(e,"click",t[14])},p:r,i(t){a||(f(i.$$.fragment,t),f(g.$$.fragment,t),a=!0)},o(t){u(i.$$.fragment,t),u(g.$$.fragment,t),a=!1},d(t){t&&c(e),d(i),d(g),s()}}}(t);const dt=new Q({props:{mailbox:t[0],selection:H([t[1]])}});dt.$on("moved",t[16]);let wt=t[4].attachments&&t[4].attachments.length&&bt(t);return{c(){e=x("x-action-group"),n=x("a"),m(tt.$$.fragment),a=k(),m(et.$$.fragment),g=k(),p=x("x-action-group"),b=x("x-action"),m(nt.$$.fragment),v=k(),B.c(),_=k(),T&&T.c(),C=k(),E=x("x-action"),m(it.$$.fragment),N=k(),m(mt.$$.fragment),U=k(),I=x("x-action-group"),Z=x("x-action"),m($t.$$.fragment),q=k(),m(ft.$$.fragment),A=k(),ut&&ut.c(),F=k(),G=x("x-action-group"),m(dt.$$.fragment),J=k(),wt&&wt.c(),K=y(),s(n,"class","x-action btn-dark"),s(n,"href",i="#!/mailbox/"+t[3].id),s(n,"data-tooltip","Volver al buzón"),w(b,"class","btn-dark"),w(b,"data-tooltip",D=t[4].seen?"Marcar como no leí­do":"Marcar como leído"),w(E,"class","btn-dark"),w(E,"data-tooltip",S=t[9]?"Descartar borrador":t[8]?"Eliminar definitivamente":"Eliminar"),w(Z,"class","btn-dark"),w(Z,"data-tooltip","Reenviar")},m(s,r,c){o(s,e,r),l(e,n),$(tt,n,null),l(n,a),$(et,n,null),o(s,g,r),o(s,p,r),l(p,b),$(nt,b,null),l(b,v),st[M].m(b,null),l(p,_),~z&&ct[z].m(p,null),l(p,C),l(p,E),$(it,E,null),l(E,N),$(mt,E,null),o(s,U,r),o(s,I,r),l(I,Z),$($t,Z,null),l(Z,q),$(ft,Z,null),l(I,A),ut&&ut.m(I,null),o(s,F,r),o(s,G,r),$(dt,G,null),o(s,J,r),wt&&wt.m(s,r),o(s,K,r),W=!0,c&&V(Y),Y=[R(b,"click",t[11]),R(E,"click",t[13]),R(Z,"click",t[15])]},p(t,e){(!W||8&e&&i!==(i="#!/mailbox/"+t[3].id))&&s(n,"href",i);let a=M;M=lt(t),M!==a&&(j(),u(st[a],1,1,()=>{st[a]=null}),L(),B=st[M],B||(B=st[M]=at[M](t),B.c()),f(B,1),B.m(b,null)),(!W||16&e&&D!==(D=t[4].seen?"Marcar como no leí­do":"Marcar como leído"))&&w(b,"data-tooltip",D),T&&T.p(t,e),t[9]||t[10]||ut.p(t,e);const o={};1&e&&(o.mailbox=t[0]),2&e&&(o.selection=H([t[1]])),dt.$set(o),t[4].attachments&&t[4].attachments.length?wt?(wt.p(t,e),16&e&&f(wt,1)):(wt=bt(t),wt.c(),f(wt,1),wt.m(K.parentNode,K)):wt&&(j(),u(wt,1,1,()=>{wt=null}),L())},i(t){W||(f(tt.$$.fragment,t),f(et.$$.fragment,t),f(nt.$$.fragment,t),f(B),f(T),f(it.$$.fragment,t),f(mt.$$.fragment,t),f($t.$$.fragment,t),f(ft.$$.fragment,t),f(ut),f(dt.$$.fragment,t),f(wt),W=!0)},o(t){u(tt.$$.fragment,t),u(et.$$.fragment,t),u(nt.$$.fragment,t),u(B),u(T),u(it.$$.fragment,t),u(mt.$$.fragment,t),u($t.$$.fragment,t),u(ft.$$.fragment,t),u(ut),u(dt.$$.fragment,t),u(wt),W=!1},d(t){t&&c(e),d(tt),d(et),t&&c(g),t&&c(p),d(nt),st[M].d(),~z&&ct[z].d(),d(it),d(mt),t&&c(U),t&&c(I),d($t),d(ft),ut&&ut.d(),t&&c(F),t&&c(G),d(dt),t&&c(J),wt&&wt.d(t),t&&c(K),V(Y)}}}function vt(t){let e;function n(t,e){return t[4].from.name?yt:kt}let a=n(t),s=a(t);return{c(){e=x("x-message-from"),s.c(),w(e,"class","svelte-1akrpub")},m(t,n){o(t,e,n),s.m(e,null)},p(t,o){a===(a=n(t))&&s?s.p(t,o):(s.d(1),s=a(t),s&&(s.c(),s.m(e,null)))},d(t){t&&c(e),s.d()}}}function kt(t){let e,n,a,r=t[4].from.address+"";return{c(){e=b("De:\n            "),n=x("span"),a=b(r),s(n,"class","from-main svelte-1akrpub")},m(t,s){o(t,e,s),o(t,n,s),l(n,a)},p(t,e){16&e&&r!==(r=t[4].from.address+"")&&v(a,r)},d(t){t&&c(e),t&&c(n)}}}function yt(t){let e,n,a,r,i,m,$,f=t[4].from.name+"",u=t[4].from.address+"";return{c(){e=b("De: \n            "),n=x("span"),a=b(f),r=k(),i=b("<"),m=b(u),$=b(">"),s(n,"class","from-main svelte-1akrpub")},m(t,s){o(t,e,s),o(t,n,s),l(n,a),o(t,r,s),o(t,i,s),o(t,m,s),o(t,$,s)},p(t,e){16&e&&f!==(f=t[4].from.name+"")&&v(a,f),16&e&&u!==(u=t[4].from.address+"")&&v(m,u)},d(t){t&&c(e),t&&c(n),t&&c(r),t&&c(i),t&&c(m),t&&c($)}}}function jt(t){let e,n,a,s=t[4].to.map(_t).join(", ")+"";return{c(){e=x("x-message-to"),n=b("Para: "),a=b(s),w(e,"class","svelte-1akrpub")},m(t,s){o(t,e,s),l(e,n),l(e,a)},p(t,e){16&e&&s!==(s=t[4].to.map(_t).join(", ")+"")&&v(a,s)},d(t){t&&c(e)}}}function Lt(t){let e,n,a,s=new Date(t[4].date).toLocaleString()+"";return{c(){e=x("x-message-date"),n=b("Enviado: "),a=b(s),w(e,"class","svelte-1akrpub")},m(t,s){o(t,e,s),l(e,n),l(e,a)},p(t,e){16&e&&s!==(s=new Date(t[4].date).toLocaleString()+"")&&v(a,s)},d(t){t&&c(e)}}}function Mt(t){let e,n,a=t[4].text+"";return{c(){e=x("pre"),n=b(a)},m(t,a){o(t,e,a),l(e,n)},p(t,e){16&e&&a!==(a=t[4].text+"")&&v(n,a)},d(t){t&&c(e)}}}function Bt(t){let e,n=q(t[4].html.join(""))+"";return{c(){e=new A(n,null)},m(t,n){e.m(t,n)},p(t,a){16&a&&n!==(n=q(t[4].html.join(""))+"")&&e.p(n)},d(t){t&&e.d()}}}function Dt(t){let e,n,a,s,r,i,g,p,h,y,j,L,M,B=t[4].subject+"";const D=new Y({props:{scrolled:0!==t[5],$$slots:{default:[wt]},$$scope:{ctx:t}}});let _=t[4].from&&vt(t),z=t[4].to&&jt(t),T=t[4].date&&Lt(t);function C(t,e){return t[4].html&&t[4].html.length?Bt:((null==j||16&e)&&(j=!(!t[4].text||!t[4].text.trim())),j?Mt:void 0)}let E=C(t,-1),N=E&&E(t);return{c(){m(D.$$.fragment),e=k(),n=x("x-tab-content"),a=x("x-message-title"),s=b(B),r=k(),i=x("x-message-info"),_&&_.c(),g=k(),z&&z.c(),p=k(),T&&T.c(),h=k(),y=x("x-message-content"),N&&N.c(),w(a,"class","svelte-1akrpub"),w(i,"class","svelte-1akrpub"),w(y,"class","svelte-1akrpub"),w(n,"class","svelte-1akrpub")},m(c,m,f){$(D,c,m),o(c,e,m),o(c,n,m),l(n,a),l(a,s),l(n,r),l(n,i),_&&_.m(i,null),l(i,g),z&&z.m(i,null),l(i,p),T&&T.m(i,null),l(n,h),l(n,y),N&&N.m(y,null),L=!0,f&&M(),M=R(n,"scroll",t[6])},p(t,e){const n={};32&e&&(n.scrolled=0!==t[5]),262171&e&&(n.$$scope={dirty:e,ctx:t}),D.$set(n),(!L||16&e)&&B!==(B=t[4].subject+"")&&v(s,B),t[4].from?_?_.p(t,e):(_=vt(t),_.c(),_.m(i,g)):_&&(_.d(1),_=null),t[4].to?z?z.p(t,e):(z=jt(t),z.c(),z.m(i,p)):z&&(z.d(1),z=null),t[4].date?T?T.p(t,e):(T=Lt(t),T.c(),T.m(i,null)):T&&(T.d(1),T=null),E===(E=C(t,e))&&N?N.p(t,e):(N&&N.d(1),N=E&&E(t),N&&(N.c(),N.m(y,null)))},i(t){L||(f(D.$$.fragment,t),L=!0)},o(t){u(D.$$.fragment,t),L=!1},d(t){d(D,t),t&&c(e),t&&c(n),_&&_.d(),z&&z.d(),T&&T.d(),N&&N.d(),M()}}}function Rt(t){let e;const n=new W({props:{$$slots:{default:[Dt]},$$scope:{ctx:t}}});return{c(){m(n.$$.fragment)},m(t,a){$(n,t,a),e=!0},p(t,[e]){const a={};262203&e&&(a.$$scope={dirty:e,ctx:t}),n.$set(a)},i(t){e||(f(n.$$.fragment,t),e=!0)},o(t){u(n.$$.fragment,t),e=!1},d(t){d(n,t)}}}const _t=t=>`<${t.address}>`;function zt(t,e,n){let a,s,o,l=r,c=()=>(l(),l=g(u,t=>n(3,a=t)),u),i=r,m=()=>(i(),i=g(d,t=>n(4,s=t)),d),$=r,f=()=>($(),$=g(p,t=>n(5,o=t)),p);t.$$.on_destroy.push(()=>l()),t.$$.on_destroy.push(()=>i()),t.$$.on_destroy.push(()=>$());let{mailbox:u}=e;c();let{message:d}=e;m();let{scroll:p}=e;f();let h=_===u,x=z===u,b=T===u,w=C===u;const v=t=>{let e=!1;return async()=>{if(!e){e=!0;try{await t()}catch(t){throw t}finally{e=!1}}}},k=v(async()=>{await Z(a.id,[s.id],!s.seen),d.update(t=>({...t,seen:!t.seen}))}),y=v(async()=>{await E(a.id,[s.id],!h),location.hash="#!/mailbox/"+a.id}),j=v(async()=>{await N(a.id,[s.id]),location.hash="#!/mailbox/"+a.id}),L=v(async()=>{const t=await S(a.id,s.id);U(H(t))}),M=v(async()=>{const t=await I(a.id,s.id);U(H(t))});return t.$set=t=>{"mailbox"in t&&c(n(0,u=t.mailbox)),"message"in t&&m(n(1,d=t.message)),"scroll"in t&&f(n(2,p=t.scroll))},[u,d,p,a,s,o,t=>p.set(t.target.scrollTop),h,x,b,w,k,y,j,L,M,()=>setTimeout(()=>location.hash="#!/mailbox/"+a.id,250)]}class Tt extends t{constructor(t){super(),e(this,t,zt,Rt,n,{mailbox:0,message:1,scroll:2})}}function Ct(t){let e;const n=new Tt({props:{mailbox:t[0],message:t[1],scroll:t[2]}});return{c(){m(n.$$.fragment)},m(t,a){$(n,t,a),e=!0},p(t,[e]){const a={};1&e&&(a.mailbox=t[0]),2&e&&(a.message=t[1]),4&e&&(a.scroll=t[2]),n.$set(a)},i(t){e||(f(n.$$.fragment,t),e=!0)},o(t){u(n.$$.fragment,t),e=!1},d(t){d(n,t)}}}async function Et(t){if(!G.get())return this.redirect("#!/login");const e=await J(t.params.mailbox);if(null==e)return this.redirect("#!/");try{const n=await K(t.params.mailbox,t.params.message);return{mailbox:e,message:H(n),scroll:H(0)}}catch(t){this.redirect("#!/mailbox/"+e.get().id)}}function Nt(t,e,n){let{mailbox:a}=e,{message:s}=e,{scroll:o}=e;return t.$set=t=>{"mailbox"in t&&n(0,a=t.mailbox),"message"in t&&n(1,s=t.message),"scroll"in t&&n(2,o=t.scroll)},[a,s,o]}export default class extends t{constructor(t){super(),e(this,t,Nt,Ct,n,{mailbox:0,message:1,scroll:2})}}export{Et as preload};
//# sourceMappingURL=Message-f9c72e3f.js.map
